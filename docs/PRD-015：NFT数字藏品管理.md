# PRD-015：NFT数字藏品管理（适配Trae开发）

## 1. 概述
- **目标用户**：总部IP运营、门店活动策划、KOC、NFT收藏用户。
- **核心价值**：构建虚实融合的NFT数字藏品体系，通过NFT绑定实体权益，增强用户粘性与品牌忠诚度，实现合规流转与社交裂变。
- **技术目标**：基于联盟链发行NFT，支持多链兼容，集成智能合约，与会员系统、盲盒系统、KOC系统深度联动，确保流转可追溯，符合国内外监管要求。

## 2. 用户故事
- 作为**IP运营**，我想要创建NFT藏品模板（实体联动款/会员专属款等），设置发行量、稀有度、权益（如盲盒折扣、线下优先体验）。
- 作为**会员**，我可以通过消费、活动获得NFT，在小程序查看、分享、赠送好友，并享受实体权益。
- 作为**KOC**，我可以获得专属NFT空投，解锁额外推广提成。
- 作为**财务**，我需要确保NFT流转记录可追溯，用于税务申报。

## 3. 功能列表（按优先级）

### 3.1 藏品体系管理（P0）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| N01 | NFT模板配置 | 创建NFT模板（名称、系列、图片/3D模型、发行总量、稀有度、权益描述）。 | 接口：`/api/nft/templates` | 模板保存成功 |
| N02 | 权益绑定 | 支持将NFT与实体权益绑定（如盲盒折扣、成长值加速、KOC推广特权），权益规则可配置。 | 规则引擎 | 权益生效准确 |
| N03 | 发行管理 | 支持多种发行方式（购买盲盒赠送、活动空投、KOC奖励），可设置发行时间、数量。 | 定时任务 + 事件触发 | 发行记录准确 |

### 3.2 藏品获取与流转（P0）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| N04 | 获取NFT | 用户满足条件时自动获得NFT，生成唯一链上标识，展示在小程序“我的藏品”中。 | 智能合约调用 | 获取成功率100% |
| N05 | 好友赠送 | 支持NFT在系统内合规流转（好友赠送），需验证双方好友关系，每月限5次。 | 社交关系验证 + 合约调用 | 流转记录上链 |
| N06 | 流转监控 | 实时监控NFT流转次数，超限自动拦截，异常触发风控。 | 规则引擎 | 拦截准确 |
| N07 | 区块链存证 | 所有NFT生成、流转记录上链，提供存证哈希和验证入口。 | 联盟链节点 | 存证可查 |

### 3.3 藏品赋能（P1）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| N08 | 鉴赏任务 | NFT持有者可参与鉴赏任务（如投票、评价），获得积分奖励。 | 活动引擎 | 积分发放准确 |
| N09 | 积分分红 | 稀有款NFT可享积分分红（如每笔消费积分按比例分红）。 | 财务底座 | 分红计算准确 |
| N10 | KOC专属NFT | KOC持有的专属NFT可解锁额外推广提成，禁止转售。 | KOC系统联动 | 提成比例正确 |

### 3.4 合规保障（P0）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| N11 | 资质声明 | NFT页面显著标注“本藏品为数字权益凭证，不可交易炒作”。 | 前端展示 | 合规 |
| N12 | 反洗钱 | 赠送功能需验证双方真实社交关系，防止洗钱。 | 社交图谱 | 阻断可疑交易 |

## 4. 技术架构
- **链**：联盟链（Hyperledger Fabric/FISCO BCOS）或合规公链侧链。
- **合约**：Solidity/Go合约，支持ERC721-like标准。
- **后端**：Spring Boot + Web3j，与链交互。
- **数据**：MySQL（模板、权益）、区块链（存证）。

## 5. 接口设计示例
- **空投NFT**：
  - `POST /api/nft/airdrop`
  - 请求：
    ```json
    {
      "templateId": 1001,
      "userIds": [12345, 67890],
      "reason": "KOC_奖励"
    }
    ```

## 6. 验收标准
- NFT生成、流转记录上链延迟≤10秒。
- 赠送限制生效准确。
- 存证可验证。

## 7. 依赖模块
- **会员系统**：用户身份。
- **KOC系统**：专属空投。
- **财务底座**：分红计算。

---
**版本历史**：
| 版本 | 日期 | 修改内容 | 作者 |
|------|------|----------|------|
| V1.0 | 2025-03-02 | 初始版本 | 产品团队 |