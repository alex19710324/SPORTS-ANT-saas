# PRD-038：智能排班与工时管理（适配Trae开发）

## 1. 概述
- **目标用户**：店长、值班经理、HR专员、门店员工。
- **核心价值**：实现门店员工排班的智能化、精细化、自动化，结合客流预测、员工技能、劳动合规，优化人力配置，降低人力成本，提升员工满意度。
- **技术目标**：基于Spring Boot + Vue3微服务架构，集成AI底座（客流预测）、HR系统（员工信息、考勤）、通讯社媒底座（通知），支持可视化排班、智能推荐、工时统计、合规校验，排班效率提升50%。

## 2. 用户故事
- 作为**店长**，我想要根据下周客流预测，系统自动推荐各岗位所需人数，我只需微调即可发布排班表。
- 作为**值班经理**，我需要处理临时请假申请，系统自动推荐可替班人员，一键完成调班。
- 作为**导玩员**，我在手机上查看下周排班，如有冲突可在线申请调班，经审批后自动更新。
- 作为**HR专员**，我想要统计员工月度工时，核算加班费，并确保符合劳动法（如每周不超过40小时）。

## 3. 功能列表（按优先级）

### 3.1 基础配置（P0）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| SC01 | 岗位与技能标签 | 配置门店各岗位（前台、导玩、技术、保洁等），以及员工技能标签（如“可操作VR设备”、“擅长儿童互动”）。 | 接口：`/api/schedule/skills` | 标签灵活 |
| SC02 | 班次模板 | 定义常用班次（早班09:00-18:00、晚班13:00-22:00、高峰班等），支持设置休息时间。 | 接口：`POST /api/schedule/shifts` | 模板可复用 |
| SC03 | 合规规则配置 | 配置劳动法合规规则（最长连续工时、每周最大工时、夜班限制等），系统自动校验。 | 规则引擎 | 规则生效 |

### 3.2 智能排班生成（P0）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| SC04 | 客流预测接入 | 从AI底座获取未来7天门店客流预测（按小时）。 | 接口：`GET /api/ai/forecast` | 数据准时 |
| SC05 | 人力需求计算 | 根据客流预测、岗位标准（如每50客流需1名导玩员），自动计算各时段各岗位所需人数。 | 规则引擎 + AI | 计算合理 |
| SC06 | 智能排班推荐 | 系统根据员工可用时间、技能标签、历史偏好，自动生成初步排班表，支持人工拖拽调整。 | 算法推荐 | 采纳率≥80% |
| SC07 | 排班发布 | 排班表确认后一键发布，自动推送至员工工作台，支持在线确认。 | 通讯社媒底座 | 送达率100% |

### 3.3 排班调整与换班（P1）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| SC08 | 请假申请 | 员工提交请假申请，关联排班，系统自动计算需替班时段。 | 接口：`POST /api/schedule/leave` | 申请可追踪 |
| SC09 | 智能替班推荐 | 请假审批通过后，系统自动推荐符合技能、可用时间的替班人员，主管可一键调班。 | 规则引擎 | 推荐准确 |
| SC10 | 换班申请 | 员工可发起换班申请，双方确认后经主管审批，自动更新排班。 | 工作流 | 换班闭环 |

### 3.4 工时统计与合规（P1）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| SC11 | 工时统计 | 根据实际打卡记录和排班表，自动统计员工每日/每周/月度工时。 | 考勤系统集成 | 数据准确 |
| SC12 | 加班计算 | 自动识别加班时段，按规则计算加班费。 | 规则引擎 | 计算准确 |
| SC13 | 合规预警 | 当排班可能导致员工超时工作时，自动预警并阻止发布。 | 规则引擎 | 拦截准确 |

### 3.5 数据分析与报表（P2）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| SC14 | 人力成本看板 | 展示各岗位人力成本、工时利用率、加班占比，与营收对比分析。 | 数据中台 | 报表清晰 |
| SC15 | 排班满意度 | 统计员工对排班的满意度（如换班成功率、加班抱怨率）。 | 问卷/反馈 | 数据可查 |

## 4. 技术架构
- **前端**：Vue3（管理后台），嵌入员工工作台（移动端）。
- **后端**：Spring Boot + 排班微服务。
- **数据**：MySQL（排班、工时）、Redis（缓存）、Elasticsearch（日志）。
- **底座依赖**：
  - AI底座：客流预测。
  - 通讯社媒底座：通知。
  - HR系统：员工信息、考勤。

## 5. 接口设计示例
- **生成排班推荐**：
  - `POST /api/schedule/recommend`
  - 请求：
    ```json
    {
      "startDate": "2025-03-10",
      "endDate": "2025-03-16",
      "storeId": 1001
    }
    ```
  - 响应：排班推荐数据（二维表）。

## 6. 验收标准
- 排班推荐采纳率≥80%。
- 合规校验准确拦截违规排班。
- 工时统计与打卡数据一致。

## 7. 依赖模块
- **AI底座**：客流预测。
- **通讯社媒底座**：通知。
- **HR系统**：员工、考勤。

---
**版本历史**：
| 版本 | 日期 | 修改内容 | 作者 |
|------|------|----------|------|
| V1.0 | 2025-03-03 | 初始版本 | 产品团队 |