# PRD-004：品牌总部管控后台（深圳Party Day模板版·适配Trae开发）

## 1. 概述
- **目标用户**：品牌总部运营者、区域经理、加盟商管理团队、供应链管理人员、财务决策者。
- **核心价值**：提供全球多门店统一管控平台，实现加盟商管理、供应链协同、全域数据决策、营销策略统一下发，助力品牌规模化扩张与精细化运营。
- **技术目标**：基于Spring Boot + Vue3微服务架构，通过AI底座、语言底座、通讯社媒底座、财务底座实现全球化运营。后台需支持多语言切换（中/英/西/法等），权限分级（总部-区域-门店），数据实时聚合。

## 2. 用户故事
- 作为**总部运营总监**，我想要实时监控全球所有门店的营收、客流、设备健康度、KOC贡献等核心指标，并生成多维度对比报表，以便快速定位问题门店和增长机会。
- 作为**区域经理**，我想要查看所辖区域内各门店的运营数据，下发统一营销活动，审核加盟商申请，协调区域内资源调配。
- 作为**加盟商管理专员**，我想要处理加盟商入驻申请，审核资质，配置加盟权限，跟踪加盟费结算。
- 作为**供应链经理**，我想要管理供应商信息，创建采购订单，跟踪物流状态，分析采购成本，确保门店物资供应。
- 作为**财务总监**，我想要查看集团合并财务报表（利润表、资产负债表、现金流量表），分析各区域税负率、成本结构，进行现金流预测。
- 作为**市场总监**，我想要创建并分发全国性营销活动，监控各区域执行效果，优化投放策略。

## 3. 功能列表（按优先级）

### 3.1 多门店监控与报表（P0）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| HQ01 | 全球门店地图看板 | 以地图形式展示所有门店位置，点击显示门店实时数据快照（今日营收、客流、预警数）。支持按国家/区域筛选。 | 集成地图API，数据实时聚合。 | 地图加载≤3秒，数据延迟≤1分钟 |
| HQ02 | 核心指标总览 | 展示全品牌累计营收、总客流、活跃会员数、KOC总数、设备在线率、综合税负率等，支持同比/环比。 | 数据中台聚合，接口：`GET /api/hq/dashboard/overview` | 数据延迟≤5分钟 |
| HQ03 | 门店对比分析 | 支持多门店横向对比（营收、客流、转化率、复购率、成本利润率），图表可视化。 | 接口：`GET /api/hq/stores/compare?storeIds=...` | 对比数据准确 |
| HQ04 | 区域报表导出 | 按区域/国家导出日报/月报（含营收、客流、KOC贡献、设备故障率等），Excel/PDF格式。 | 接口：`GET /api/hq/reports/export` | 导出≤30秒 |

### 3.2 加盟商管理（P0）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| FM01 | 加盟商入驻审批 | 加盟商提交入驻申请（含资质文件），总部审核资质，在线签署电子合同，开通租户。 | 工作流引擎，电子签章集成。 | 审批流程完整，合同存证 |
| FM02 | 加盟费用结算 | 配置加盟费、分成比例、结算周期，自动生成对账单，支持线上支付/线下转账确认。 | 财务底座接口：`/api/finance/franchise` | 对账准确 |
| FM03 | 加盟商健康度看板 | 展示各加盟商运营数据（营收、客流、KOC效果），结合AI给出健康度评分及改进建议。 | AI底座分析 | 评分客观 |
| FM04 | 加盟政策模板 | 创建/编辑加盟政策模板（费用、支持政策、区域限制），一键发布至官网。 | 内容管理 | 实时生效 |

### 3.3 供应链与采购管理（P1）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| SC01 | 供应商管理 | 增删改查供应商信息（名称、联系人、资质、评级），支持供应商准入审核。 | 接口：`/api/suppliers` | 信息完整 |
| SC02 | 采购订单管理 | 创建采购订单（盲盒、礼品、耗材），选择供应商，提交审批，跟踪物流状态。 | 工作流引擎，接口：`/api/purchase-orders` | 状态实时更新 |
| SC03 | 库存预警联动 | 接收门店库存预警，自动生成补货建议，支持批量采购。 | 接口：`/api/inventory/alerts` | 预警准确 |
| SC04 | 采购成本分析 | 分析各品类采购成本趋势，支持按供应商比价，生成成本优化建议。 | 财务底座数据 | 报表清晰 |

### 3.4 全域营销管理（P1）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| MK01 | 全国性活动创建 | 创建统一营销活动（如节日大促、IP联名），选择参与门店（全部/指定区域），配置活动规则。 | 接口：`/api/hq/marketing/activities` | 活动准时下发 |
| MK02 | 活动执行监控 | 实时查看各门店活动参与人数、核销率、ROI，支持按区域下钻。 | 数据中台聚合 | 数据延迟≤5分钟 |
| MK03 | 公域投放中枢 | 对接抖音、Google、Facebook等平台，配置投放素材、预算、人群包，AI优化出价。 | 通讯社媒底座 | 投放ROI追踪 |
| MK04 | 营销方法库 | 总部审核并发布标杆营销方法（含模板、案例），门店可一键复用。 | 知识库 | 方法库可检索 |

### 3.5 财务决策支持（P1）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| FD01 | 集团合并报表 | 自动生成集团合并利润表、资产负债表、现金流量表（按多会计准则）。 | 财务底座接口 | 数据准确 |
| FD02 | 区域税负分析 | 分析各国家/地区税负率，提供税务筹划建议。 | 财务底座+AI | 建议合规 |
| FD03 | 现金流预测 | 基于历史数据和未来活动预测，生成集团现金流趋势图，预警流动性风险。 | AI模型 | 准确率≥90% |
| FD04 | 成本分摊看板 | 查看集团营销费用、管理费用在各区域的分摊情况。 | 财务底座 | 分摊规则可配置 |

### 3.6 组织与权限（P0，已在SaaS后台实现，此处仅总部扩展）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| OR01 | 区域/门店树管理 | 维护总部-区域-门店的组织架构，支持多级配置。 | 接口：`/api/hq/org` | 架构清晰 |
| OR02 | 总部角色权限 | 配置总部岗位（区域经理、财务专员、市场专员等）及权限。 | RBAC模型 | 权限隔离 |

### 3.7 数据大屏（P2）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| DS01 | 总部数据大屏 | 超大屏展示全球实时数据（营收、客流、设备状态、KOC排行榜），适合指挥中心。 | WebSocket实时推送 | 数据刷新≤1秒 |

## 4. 技术架构
- **前端**：Vue3 + TypeScript + Vuetify（海外）/ Element Plus（国内），大屏采用ECharts/DataV。
- **后端**：Spring Boot微服务，API网关统一认证（JWT），权限控制细化到数据行（区域/门店）。
- **数据**：MySQL（业务数据）+ Redis（缓存）+ ClickHouse（聚合报表）+ Hudi（数据湖）。
- **底座依赖**：
  - AI底座：健康度评分、现金流预测、税负分析。
  - 语言底座：多语言切换。
  - 通讯社媒底座：公域投放、消息通知。
  - 财务底座：财务报表、成本分摊、加盟费结算。

## 5. 接口设计示例
- **全球门店地图数据接口**：
  - `GET /api/hq/map/stores`
  - 响应：
    ```json
    {
      "stores": [
        {
          "storeId": 1001,
          "name": "深圳Party Day",
          "lat": 22.5431,
          "lng": 114.0579,
          "todayRevenue": 12345.67,
          "todayVisitors": 230,
          "alertCount": 2,
          "status": "normal"
        }
      ]
    }
    ```

- **加盟商入驻审批接口**：
  - `POST /api/hq/franchise/approve`
  - 请求：
    ```json
    {
      "applicationId": 5001,
      "approve": true,
      "comments": "资质齐全，同意入驻"
    }
    ```
  - 响应：`{ "status": "approved", "tenantId": 2001 }`

## 6. 验收标准
- 全球数据聚合延迟≤5分钟（P0指标）。
- 加盟商审批流程完整，合同存证可查。
- 采购订单与财务对账一致。
- 大屏数据实时刷新，无卡顿。
- 符合GDPR/等保2.0：敏感数据脱敏，操作日志留存。

## 7. 依赖模块
- **AI底座**：健康度评分、现金流预测、税负分析。
- **语言底座**：多语言切换。
- **通讯社媒底座**：公域投放、消息通知。
- **财务底座**：财务报表、成本分摊、加盟费结算。
- **数据中台**：实时数据聚合。

---
**版本历史**：
| 版本 | 日期 | 修改内容 | 作者 |
|------|------|----------|------|
| V1.0 | 2025-03-02 | 初始版本，基于总体规划文档 | 产品团队 |