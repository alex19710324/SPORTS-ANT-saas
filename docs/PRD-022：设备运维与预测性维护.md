# PRD-022：设备运维与预测性维护（适配Trae开发）

## 1. 概述
- **目标用户**：技术主管、技术员、安监专员、店长、设备供应商。
- **核心价值**：从被动维修转向主动预防，通过实时监控设备运行数据，利用AI模型预测故障风险，自动生成保养工单，降低设备故障率，延长设备寿命，保障门店运营连续性。
- **技术目标**：基于物联网数据采集（MQTT/Modbus），结合AI底座故障预测模型，实现设备健康度评分、剩余寿命预测、保养建议生成，与工单系统、备件系统联动，设备完好率目标≥98%。

## 2. 用户故事
- 作为**技术员**，我每天上班打开工作台，看到系统自动推送的今日重点保养设备清单，以及预测的可能故障提醒，我可以提前检查处理。
- 作为**技术主管**，我想看到全场设备的健康度评分趋势图，了解哪些设备即将达到保养周期，提前安排预防性维护计划。
- 作为**店长**，我想了解设备故障对营收的潜在影响，审批保养预算。
- 作为**供应商**，我想远程查看设备运行数据，提供更精准的售后支持。

## 3. 功能列表（按优先级）

### 3.1 设备数据采集与监控（P0）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| PM01 | 多协议数据接入 | 支持MQTT、Modbus TCP/RTU、OPC UA等工业协议，实时采集设备运行参数（温度、电流、运行时长、故障码）。 | 物联网网关 + 协议适配器 | 数据接入成功率≥99.9% |
| PM02 | 设备数字孪生 | 为每台设备建立数字模型，实时映射物理设备状态，存储历史时序数据。 | InfluxDB/TDengine | 数据点完整 |
| PM03 | 实时监控看板 | 以图表形式展示关键设备参数，支持告警阈值设置，超限自动触发告警。 | Grafana/ECharts | 数据刷新≤2秒 |
| PM04 | 健康度评分 | 综合多维度数据，实时计算设备健康度评分（0-100分），颜色标识（绿/黄/红）。 | 规则引擎 + 模型 | 评分合理 |

### 3.2 故障预测与诊断（P1）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| PM05 | 故障预测模型 | 基于历史故障数据训练AI模型，预测未来7天内设备故障概率，输出高风险设备列表。 | AI底座（时序预测/分类） | 预测准确率≥85% |
| PM06 | 剩余寿命预测 | 对关键部件（如电机、轴承）预测剩余使用寿命，提前预警。 | 退化模型 | 误差≤20% |
| PM07 | 故障诊断建议 | 当故障发生时，系统自动分析可能原因，并推送历史相似故障处理方案。 | 知识图谱 + 案例库 | 建议有用率≥70% |

### 3.3 预防性维护管理（P1）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| PM08 | 保养计划自动生成 | 根据设备运行时长、厂家建议、预测结果，自动生成保养计划（日/周/月）。 | 规则引擎 + AI | 计划合理 |
| PM09 | 保养工单下发 | 系统自动创建保养工单，分配给指定技术员，包含保养项目、注意事项。 | 工单系统 | 准时下发 |
| PM10 | 保养执行记录 | 技术员扫码确认执行，上传保养前后照片，记录更换备件。 | 接口：`POST /api/maintenance/execute` | 记录完整 |
| PM11 | 保养效果评估 | 对比保养前后设备健康度变化，评估保养效果。 | 数据分析 | 可量化 |

### 3.4 备件联动与成本分析（P2）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| PM12 | 备件需求预测 | 根据故障预测和保养计划，自动预测未来备件需求量，生成采购建议。 | AI预测 | 准确率≥80% |
| PM13 | 维修成本分析 | 统计单台设备维修总成本（备件+人工），辅助更新决策。 | 财务底座 | 数据准确 |

## 4. 技术架构
- **采集层**：边缘网关 + MQTT Broker（EMQX）。
- **存储层**：时序数据库（InfluxDB/TDengine）。
- **分析层**：Python + TensorFlow/PyTorch（预测模型）。
- **应用层**：Spring Boot + Vue3。

## 5. 接口设计示例
- **设备健康度查询**：
  - `GET /api/devices/1001/health`
  - 响应：
    ```json
    {
      "score": 85,
      "status": "warning",
      "predictedFaults": [
        { "type": "电机过热", "probability": 0.3, "daysLeft": 15 }
      ]
    }
    ```

## 6. 验收标准
- 数据采集延迟≤1秒。
- 故障预测准确率≥85%。
- 保养计划自动生成准确。
- 工单闭环率≥95%。

## 7. 依赖模块
- **AI底座**：预测模型。
- **工单系统**：任务执行。
- **备件系统**：库存联动。

---
**版本历史**：
| 版本 | 日期 | 修改内容 | 作者 |
|------|------|----------|------|
| V1.0 | 2025-03-03 | 初始版本 | 产品团队 |