# PRD-034：全员营销与激励系统（适配Trae开发）

## 1. 概述
- **目标用户**：门店全体员工（包括店长、前台、导玩员、技术员等）、总部/区域营销经理、财务人员。
- **核心价值**：激发全体员工参与营销推广的积极性，通过AI赋能的素材生成、精准的任务派发、实时的追踪归因、科学的激励结算，将员工私域流量转化为门店增量客流与销售，实现员工与门店共赢。
- **技术目标**：基于Spring Boot + Vue3微服务架构，深度集成AI底座（素材生成、潜力预测）、通讯社媒底座（分发、追踪）、财务底座（激励结算）、数据中台（效果分析），实现任务自动化、数据实时化、激励透明化，全员营销贡献占门店营收比例提升目标≥15%。

## 2. 用户故事
- 作为**导玩员**，我可以在工作台看到系统根据我的社交影响力推送的推广任务（如“推荐好友办卡”），一键获取专属海报和文案，分享到朋友圈/微信群，好友通过我的链接下单后，我实时看到收益。
- 作为**店长**，我想要为门店设置全员营销目标，查看每位员工的推广贡献排名，及时调整激励策略，并在员工离职时做好推广关系转移。
- 作为**营销经理**，我想要创建全员营销活动（如“春季拉新大赛”），配置奖励规则，追踪活动整体ROI，并分析哪些员工类型的转化率更高。
- 作为**财务人员**，我需要每月自动核算员工营销奖励，与工资一并发放，并确保税务合规。

## 3. 功能列表（按优先级）

### 3.1 员工推广者管理（P0）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| EM01 | 推广者注册 | 所有正式员工自动成为推广者（可设置开关），生成唯一推广ID。 | 接口：`POST /api/promoter/register` | 覆盖率100% |
| EM02 | 社交影响力评估 | AI根据员工社交账号（如微信好友数、社群数）评估其推广潜力，用于任务派发。 | AI底座 | 评估准确率≥80% |
| EM03 | 推广者等级 | 根据推广业绩自动划分等级（如青铜、白银、黄金），等级影响奖励系数。 | 规则引擎 | 等级实时更新 |

### 3.2 推广任务管理（P0）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| EM04 | 任务类型配置 | 支持多种任务类型：拉新（新用户注册/首购）、促活（老用户复购）、办卡、活动推广等。 | 规则引擎 | 类型可扩展 |
| EM05 | 任务创建 | 营销经理创建全员营销任务，设置目标人群、奖励规则、时间范围、参与员工范围。 | 接口：`POST /api/promotion/tasks` | 任务生效 |
| EM06 | 智能任务派发 | 系统根据员工社交影响力、历史转化率自动推送适合的任务，避免信息过载。 | AI推荐 | 任务接受率≥70% |
| EM07 | 任务素材生成 | AI自动生成专属海报、文案、短链接（带员工追踪参数），员工可一键下载/分享。 | AI内容生成引擎 | 生成时间≤3秒 |

### 3.3 推广追踪与归因（P0）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| EM08 | 追踪链接生成 | 每个任务生成专属短链，携带员工ID、任务ID、渠道参数。 | 短链服务 | 无重复 |
| EM09 | 多触点归因 | 用户点击链接后，支持30天内的转化归因（最后一次点击归因）。 | 归因引擎 | 归因准确率≥99% |
| EM10 | 实时数据看板 | 员工实时查看个人推广数据（曝光、点击、转化、预估收益）。 | WebSocket推送 | 延迟≤5秒 |
| EM11 | 防作弊机制 | 监控异常点击（如同一IP频繁点击）、虚假注册，自动冻结可疑转化，人工审核。 | 风控引擎 | 作弊拦截率≥95% |

### 3.4 激励与结算（P1）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| EM12 | 奖励规则配置 | 支持多种奖励方式：现金提成、积分、优惠券、盲盒、NFT，可设置阶梯奖励。 | 规则引擎 | 规则灵活 |
| EM13 | 实时收益计算 | 每笔有效转化实时计算预估收益，展示在员工收益看板。 | 流计算 | 计算准确 |
| EM14 | 月度结算 | 每月自动汇总员工推广收益，生成结算单，推送至财务底座。 | 定时任务 + 财务接口 | 结算准确率100% |
| EM15 | 税务处理 | 自动计算个税，支持合规发放（工资合并或劳务报酬）。 | 财务底座 | 税务合规 |
| EM16 | 提现/发放 | 支持员工提现至微信/支付宝，或随工资发放。 | 支付网关 | 发放成功率≥99% |

### 3.5 团队与组织管理（P1）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| EM17 | 门店团队看板 | 店长可查看本店员工推广排行榜、团队总贡献。 | 接口：`GET /api/promotion/team` | 数据实时 |
| EM18 | 推广关系转移 | 员工离职时，可将未完成的推广关系转移给接替员工或团队公共账号。 | 工作流 | 转移可追溯 |
| EM19 | 区域对比 | 区域经理可对比不同门店的全员营销效果。 | 数据中台 | 报表清晰 |

### 3.6 效果分析与优化（P2）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| EM20 | 活动ROI分析 | 分析每次全员营销活动的总成本（奖励+管理）、总收益（拉新/复购GMV），计算ROI。 | 数据中台 | 分析准确 |
| EM21 | 员工效能分析 | 分析不同岗位、不同等级员工的转化率、平均收益，识别高潜员工。 | AI分析 | 建议可采纳 |
| EM22 | A/B测试 | 支持对不同任务素材、奖励方式进行A/B测试，优化转化率。 | 实验平台 | 结果可量化 |

## 4. 技术架构
- **前端**：员工工作台（移动端嵌入），管理后台（Vue3 + Element Plus）。
- **后端**：Spring Boot + 全员营销微服务。
- **数据**：MySQL（任务、收益）、Redis（实时数据）、ClickHouse（分析报表）。
- **底座依赖**：
  - AI底座：社交影响力评估、素材生成。
  - 通讯社媒底座：分享追踪、短链。
  - 财务底座：激励结算、税务。
  - 数据中台：效果分析、归因。

## 5. 接口设计示例
- **员工获取推荐素材**：
  - `GET /api/promotion/materials?taskId=1001`
  - 响应：
    ```json
    {
      "posterUrl": "https://cdn.xxx.com/poster/1001.jpg",
      "shareText": "超值福利！好友办卡送盲盒...",
      "shortLink": "https://s.xxx.com/abc123"
    }
    ```

- **上报转化事件**（由订单系统回调）：
  - `POST /api/promotion/conversion`
  - 请求：
    ```json
    {
      "orderId": 3001,
      "userId": 12345,
      "shortLinkCode": "abc123",
      "amount": 199.00
    }
    ```

## 6. 验收标准
- 员工端任务接受率≥70%。
- 追踪归因准确率≥99%。
- 激励结算准确率100%，发放成功率≥99%。
- 作弊拦截率≥95%。
- 活动ROI分析报表准确。

## 7. 依赖模块
- **AI底座**：社交影响力评估、素材生成。
- **通讯社媒底座**：短链、分享追踪。
- **财务底座**：激励结算、税务。
- **数据中台**：归因、分析。
- **员工工作台**：前端入口。

---
**版本历史**：
| 版本 | 日期 | 修改内容 | 作者 |
|------|------|----------|------|
| V1.0 | 2025-03-03 | 初始版本，整合全员营销需求 | 产品团队 |