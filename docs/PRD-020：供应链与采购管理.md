# PRD-020：供应链与采购管理（适配Trae开发）

## 1. 概述
- **目标用户**：总部采购经理、仓管员、财务人员、店长（发起采购申请）。
- **核心价值**：实现从供应商管理、采购申请、审批、订单执行、物流追踪到库存联动的全链路数字化供应链管理，降低采购成本，保障物资供应，优化库存周转。
- **技术目标**：基于Spring Boot + Vue3微服务架构，集成工作流引擎、财务底座（结算）、数据中台（库存分析），支持多门店、多供应商、多币种采购，与库存系统实时联动。

## 2. 用户故事
- 作为**仓管员**，我想要在库存低于安全库存时自动生成补货建议，发起采购申请，并跟踪采购订单状态。
- 作为**采购经理**，我想要审核采购申请，选择供应商，下达采购订单，并监控到货情况。
- 作为**财务人员**，我想要根据采购订单和入库单生成应付账款，安排付款。
- 作为**店长**，我想要为门店申请采购特殊物资（如活动奖品、定制礼品），并查看本店采购预算执行情况。

## 3. 功能列表（按优先级）

### 3.1 供应商管理（P0）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| SC01 | 供应商档案 | 维护供应商基本信息（名称、联系人、联系方式、资质文件、合作状态），支持分类、评级。 | 接口：`/api/suppliers` | 档案完整 |
| SC02 | 供应商准入 | 新供应商申请入驻，提交资质，总部审核通过后纳入合格供应商库。 | 工作流引擎 | 流程闭环 |
| SC03 | 供应商评估 | 根据交货及时率、质量合格率、价格水平等自动生成绩效评分，辅助采购决策。 | 数据中台 | 评分客观 |

### 3.2 采购需求管理（P0）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| SC04 | 库存预警触发 | 当门店/仓库库存低于安全库存时，系统自动生成补货建议，推送至采购模块。 | 库存服务 + 规则引擎 | 预警准确 |
| SC05 | 采购申请 | 门店或总部可手动发起采购申请，填写物资清单、数量、期望到货日期，关联预算。 | 接口：`POST /api/purchase/requests` | 申请可追溯 |
| SC06 | 采购审批 | 支持多级审批流（如店长→区域经理→总部采购），审批过程中可修改、驳回。 | 工作流引擎 | 审批灵活 |

### 3.3 采购订单执行（P1）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| SC07 | 询价比价 | 采购员可选择多个供应商发送询价单，供应商在线报价，系统自动比价。 | 接口：`POST /api/purchase/inquiry` | 比价清晰 |
| SC08 | 采购订单生成 | 选择供应商后生成采购订单（PO），明确物资明细、单价、总价、交期、付款条款。 | 接口：`POST /api/purchase/orders` | 订单准确 |
| SC09 | 订单确认与下发 | 支持发送订单至供应商（邮件/系统消息），供应商可在线确认。 | 通讯社媒底座 | 确认及时 |
| SC10 | 物流跟踪 | 对接物流商API，实时跟踪订单物流状态（发货、运输、签收）。 | 物流接口 | 状态同步 |
| SC11 | 到货验收 | 仓库收到物资后扫码/手动录入实收数量、质量情况，生成入库单。 | 接口：`POST /api/purchase/receipt` | 入库准确 |

### 3.4 采购结算（P1，与财务底座联动）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| SC12 | 发票管理 | 供应商上传发票，系统自动与采购订单、入库单匹配（三单匹配），异常标记。 | OCR + 规则引擎 | 匹配准确 |
| SC13 | 应付账款 | 根据匹配结果生成应付账款，推送至财务底座，安排付款计划。 | 财务底座 | 账务一致 |
| SC14 | 采购成本分析 | 分析各品类采购成本趋势、供应商价格对比，辅助降本决策。 | 数据中台 | 报表清晰 |

### 3.5 库存联动（P0）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| SC15 | 实时库存同步 | 采购订单确认后，自动锁定库存（预占）；到货入库后更新实时库存。 | 库存服务 | 数据一致 |
| SC16 | 库存周转分析 | 计算各品类库存周转率，提供呆滞库存预警。 | 数据中台 | 预警及时 |

## 4. 技术架构
- **前端**：Vue3 + Element Plus（管理后台）。
- **后端**：Spring Boot微服务，独立采购模块。
- **数据**：MySQL（供应商、采购单）、Redis（库存锁）、Elasticsearch（日志）。
- **底座依赖**：
  - 通讯社媒底座：通知、询价。
  - 财务底座：应付账款、付款。
  - 数据中台：库存分析。

## 5. 接口设计示例
- **创建采购申请**：
  - `POST /api/purchase/requests`
  - 请求：
    ```json
    {
      "storeId": 1001,
      "requesterId": 123,
      "items": [
        { "sku": "GIFT001", "name": "盲盒", "quantity": 100, "estimatedPrice": 30.0 }
      ],
      "expectedDate": "2025-04-01",
      "budgetCode": "BUDGET-001"
    }
    ```

## 6. 验收标准
- 采购申请到订单执行全流程可追踪。
- 三单匹配准确率≥99%。
- 库存预警自动触发补货。
- 与财务对账一致。

## 7. 依赖模块
- **通讯社媒底座**：通知。
- **财务底座**：结算。
- **数据中台**：分析。
- **库存系统**：联动。

---
**版本历史**：
| 版本 | 日期 | 修改内容 | 作者 |
|------|------|----------|------|
| V1.0 | 2025-03-03 | 初始版本 | 产品团队 |