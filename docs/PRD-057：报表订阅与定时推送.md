# PRD-057：报表订阅与定时推送（适配Trae开发）

## 1. 概述
- **目标用户**：管理层、运营、财务等需要定期收到报表的人员。
- **核心价值**：支持报表的订阅、定时生成、多渠道推送，让决策者第一时间获取关键数据。
- **技术目标**：基于数据中台+调度引擎，支持日报/周报/月报配置、多种格式（PDF/Excel）、多渠道发送。

## 2. 用户故事
- 作为**运营总监**，我订阅了全国门店日报，每天上午9点自动收到邮件和企微推送的PDF报表。
- 作为**财务**，我需要每月5日生成上月财务报表，并发送给总部邮箱。

## 3. 功能列表（按优先级）

### 3.1 报表配置（P0）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| RS01 | 报表模板 | 选择已有报表（如营收日报），可自定义列、排序、筛选。 | 接口：`/api/report/templates` | 配置灵活 |
| RS02 | 订阅配置 | 设置接收人（员工、部门、外部邮箱）、推送渠道（邮件、企微、钉钉）、时间（每日9点）。 | 规则引擎 | 配置生效 |

### 3.2 定时生成（P0）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| RS03 | 调度任务 | 根据订阅时间自动触发报表生成任务，支持多格式（PDF/Excel）。 | 定时任务 | 准时生成 |
| RS04 | 失败重试 | 生成失败自动重试3次，仍失败告警管理员。 | 重试机制 | 成功率≥99% |

### 3.3 推送与历史（P1）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| RS05 | 多渠道推送 | 通过邮件、企微、钉钉、小程序消息发送报表。 | 消息通知中心 | 送达成功 |
| RS06 | 历史记录 | 可查看历史推送记录，支持重新发送。 | 接口：`GET /api/report/history` | 可追溯 |

## 4. 依赖模块
- 数据中台（PRD-011）
- 消息通知中心（PRD-043）
- 定时调度引擎

---
**版本历史**：V1.0 2025-03-03