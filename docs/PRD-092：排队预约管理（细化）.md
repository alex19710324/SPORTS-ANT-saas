# PRD-092：排队预约管理（细化）（适配Trae开发）

## 1. 概述
- **目标用户**：顾客、导玩员、运行专员。
- **核心价值**：支持热门项目（VR、卡丁车）的线上排队取号、微信提醒、过号重排，减少现场等待焦虑，提升体验。
- **技术目标**：基于WebSocket + 消息推送，实现实时排队状态同步、叫号通知。

## 2. 用户故事
- 作为**顾客**，我在小程序上取号排队VR，实时看到前面还有几人，到号时收到推送通知，返回体验。

## 3. 功能列表（按优先级）

### 3.1 排队规则配置（P0）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| QM01 | 项目配置 | 选择支持排队的项目，设置最大排队人数、预计时长。 | 接口：`/api/queue/projects` | 生效 |
| QM02 | 过号规则 | 配置过号作废、顺延等规则。 | 规则引擎 | 规则生效 |

### 3.2 取号与叫号（P0）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| QM03 | 线上取号 | 用户在小程序取号，生成排队号、前面人数。 | 接口：`POST /api/queue/take` | 取号成功 |
| QM04 | 排队状态 | 实时更新排队进度，支持WebSocket推送。 | WebSocket | 实时 |
| QM05 | 叫号通知 | 到号时推送小程序/短信通知，语音广播（可选）。 | 消息中心 | 通知及时 |

### 3.3 现场管理（P1）

| ID | 功能名称 | 描述 | 技术实现要点 | 验收标准 |
|----|----------|------|--------------|----------|
| QM06 | 过号处理 | 用户过号后可选择重新排队。 | 接口：`POST /api/queue/rejoin` | 处理准确 |

## 4. 依赖模块
- 消息通知中心（PRD-043）

---
**版本历史**：V1.0 2025-03-03